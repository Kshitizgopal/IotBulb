<!DOCTYPE html>
<html>
<head>
    <title>ESP32 Firebase Control</title>
    <meta charset="UTF-8">
</head>
<body>
    <h2>ESP32 Firebase Control Panel</h2>

    <div>
        <input type="email" id="email" placeholder="Email">
        <input type="password" id="password" placeholder="Password">
        <button id="loginBtn">Login</button>
    </div>

    <hr>

    <div id="controls" style="display:none;">
        <h3>Light Control</h3>
        <button onclick="setLight(true)">Turn ON</button>
        <button onclick="setLight(false)">Turn OFF</button>
        <p>Light Status: <span id="lightStatus">Unknown</span></p>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js"></script>

    <script>
        // TODO: Replace with your Firebase config
        const firebaseConfig = {
            apiKey: "YOUR_WEB_API_KEY",
            authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
            databaseURL: "YOUR_DATABASE_URL",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_PROJECT_ID.appspot.com",
            messagingSenderId: "YOUR_SENDER_ID",
            appId: "YOUR_APP_ID"
        };

        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const database = firebase.database();

        // Login button handler
        document.getElementById("loginBtn").addEventListener("click", () => {
            const email = document.getElementById("email").value;
            const password = document.getElementById("password").value;

            auth.signInWithEmailAndPassword(email, password)
                .then(() => {
                    document.getElementById("controls").style.display = "block";
                    listenLightStatus();
                })
                .catch((error) => {
                    alert("Login failed: " + error.message);
                });
        });

        // Set light status in database
        function setLight(state) {
            database.ref("light").set(state);
        }

        // Listen for light changes
        function listenLightStatus() {
            database.ref("light").on("value", (snapshot) => {
                const status = snapshot.val();
                document.getElementById("lightStatus").innerText = status ? "ON" : "OFF";
            });
        }
    </script>
</body>
</html>
